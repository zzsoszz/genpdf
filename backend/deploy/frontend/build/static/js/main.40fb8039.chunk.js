(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{172:function(e,t,n){"use strict";n.r(t);var a=n(57),r=n(58),l=n(64),c=n(59),o=n(65),u=n(0),i=n.n(u),d=n(16),m=n.n(d),s=(n(73),n(3)),p=n(60),f=i.a.createContext(),E=n(44)({sensitive:!1,strict:!1,end:!1}),h=n(44)({sensitive:!1,strict:!1,end:!0});function g(e){var t=Object(u.useContext)(f),n=(e.exact?h(e.path):E(e.path))(t.pathname);return console.log("Route.............",e.path,t.pathname),console.log("Route.............params",n),!1===n?null:i.a.createElement(e.component,{history:{params:n}})}function b(e){var t=Object(p.useLocation)();return i.a.createElement(f.Provider,{value:t},i.a.Children.map(e.children,function(e,t){return"function"===typeof e?e():i.a.cloneElement(e,Object(s.a)({},e.props))}))}function v(e){return i.a.createElement("a",{style:{margin:"8px"},href:e.to,onClick:function(t){t.preventDefault(),window.history.pushState(e.to,null,e.to)}},e.children)}var O=n(11),y=n(174),j=n(10),x=n.n(j),C=n(13),w=n.n(C),k=n(7),I=n.n(k),R=n(6),N=n(5);function D(){var e=Object(R.a)(["\n    padding:8px 16px;\n    color: #fff;\n    background:#001529;\n    margin:2px 0px;\n    &:hover {\n        background-color: #1890ff;\n    }\n    > *{ \n       color: #fff;\n       text-decoration:none;\n    }\n"]);return D=function(){return e},e}function S(){var e=Object(R.a)(["\n    height:100vh;\n    display:flex;\n    flex-direction:column;\n    background-color: rgb(0, 12, 23);\n"]);return S=function(){return e},e}function T(){var e=Object(R.a)(["\n  display:inline-block;\n  width:5em;\n  text-align:right;\n  margin:4px 8px;\n"]);return T=function(){return e},e}function P(){var e=Object(R.a)(["\n  padding: 4px;\n"]);return P=function(){return e},e}function U(){var e=Object(R.a)(["\n  padding: 8px;\n"]);return U=function(){return e},e}function _(){var e=Object(R.a)(["\n  padding: 8px;\n"]);return _=function(){return e},e}function A(){var e=Object(R.a)(["\n                border-color: #1890ff;\n                background:#1890ff;\n      "]);return A=function(){return e},e}function J(){var e=Object(R.a)(["\n    padding: 4px 16px;\n    border: 1px solid #ebedf0;\n    outline: 0;\n    line-height: 1.499;\n    display: inline-block;\n    font-weight: 400;\n    text-align: center;\n    color: #fff;\n    box-shadow: 0 2px 0 rgba(0,0,0,0.045);\n    cursor:pointer;\n      ","\n"]);return J=function(){return e},e}function L(){var e=Object(R.a)(["\n        text-align:center;\n  "]);return L=function(){return e},e}function F(){var e=Object(R.a)(["\n  padding: 16px;\n  border: 1px solid #ebedf0;\n  margin: 16px;\n  ","\n"]);return F=function(){return e},e}var M=N.default.div(F(),function(e){return e.center&&Object(N.css)(L())}),z=N.default.span(J(),function(e){return e.primary&&Object(N.css)(A())}),B=N.default.div(_()),G=N.default.div(U()),K=N.default.div(P()),V=N.default.label(T()),q=N.default.div(S()),H=N.default.div(D()),Q=n(14),W=n.n(Q),X=n(21);function Y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=Object(u.useState)(null),r=Object(O.a)(a,2),l=r[0],c=r[1];return Object(u.useEffect)(function(){Object(X.a)(W.a.mark(function e(){var n,a;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch.apply(void 0,t);case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:a=e.sent,c(a);case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}},e,this,[[0,11]])}))()},[]),l}var Z={baseUrl:"http://47.106.199.127:8080/gen"},$=i.a.createContext();n(63);function ee(e){return decodeURIComponent(e)}function te(e){return!isNaN(e)}var ne=Z.baseUrl+"/contractor/genpdf",ae=Z.baseUrl+"/contractor";function re(){return fetch.apply(void 0,arguments).then(function(e){if(200!=e.status){var t=e.headers.get("message");throw t=ee(t),alert(t),t}return e})}function le(){return(le=Object(X.a)(W.a.mark(function e(t){var n;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(ne,{method:"POST",headers:{Accept:"text/csv;charset=GBK","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ce(e){var t=JSON.parse(localStorage.getItem("contractor"));console.log("contractor.........",t),t.orders.filter(function(t){return t.id==e}).map(function(e){e.items.filter(function(e){return e.checked&&(isNaN(e.price)||isNaN(e.count))}).length>0&&console.log("\u6570\u636e\u586b\u5199\u6709\u8bef")});var n=Object(s.a)({},t,{orders:t.orders.filter(function(t){return t.id==e}).map(function(e){return console.log("one",e),e.items=e.items.filter(function(e){return e.checked}),e})});console.log("contractorNew",n),function(e){return le.apply(this,arguments)}(n).then(function(e){e.ok?e.blob().then(function(t){try{var n=document.createElement("a"),a=window.URL.createObjectURL(t),r=e.headers.get("Content-Disposition").split(";")[1].split("=")[1];n.href=a,n.download=ee(r),n.click(),window.URL.revokeObjectURL(a)}catch(l){alert(l)}}):alert("\u5bfc\u51fa\u5931\u8d25:"+e.status)})}var oe="ADD_ORDER",ue="UPDATE_ORDER",ie="ADD_ORDER_ITEM",de="DELETE_ORDER_ITEM",me="UPDATE_ORDER_ITEM",se="UPDATE_PERSON",pe="INIT_ORDER",fe="UPDATE_CONTRACTOR",Ee="INIT_CONTRACTOR",he=(n(149),i.a.memo(function(e){return console.log("orderitem",e),i.a.createElement(i.a.Fragment,null,i.a.createElement("tr",{style:{background:e.checked?"#bababa":""}},i.a.createElement("td",null,i.a.createElement("input",{style:{height:"20px",width:"20px"},checked:e.checked,type:"checkbox",onChange:function(t){e.onOrderItemChange(Object(s.a)({},e,{checked:!e.checked}))}})),i.a.createElement("td",null,i.a.createElement("span",null,e.index)),i.a.createElement("td",null,i.a.createElement("input",{value:e.subcategory,onChange:function(t){e.onOrderItemChange(Object(s.a)({},e,{subcategory:t.target.value}))}})),i.a.createElement("td",null,i.a.createElement("input",{value:e.name,onChange:function(t){e.onOrderItemChange(Object(s.a)({},e,{name:t.target.value}))}})),i.a.createElement("td",null,i.a.createElement("input",{value:e.subname,onChange:function(t){e.onOrderItemChange(Object(s.a)({},e,{subname:t.target.value}))}})),i.a.createElement("td",null,i.a.createElement("input",{value:e.unit,onChange:function(t){e.onOrderItemChange(Object(s.a)({},e,{unit:t.target.value}))}})),i.a.createElement("td",null,i.a.createElement("input",{value:e.price,onChange:function(t){isNaN(t.target.value)||e.onOrderItemChange(Object(s.a)({},e,{price:t.target.value}))}})),i.a.createElement("td",null,i.a.createElement("input",{value:e.count,onChange:function(t){isNaN(t.target.value)||e.onOrderItemChange(Object(s.a)({},e,{count:t.target.value}))}})),i.a.createElement("td",null,i.a.createElement("span",null,e.count&&e.price&&te(e.count)&&te(e.price)?new w.a(e.count).times(new w.a(e.price)).toFixed(2):0)),i.a.createElement("td",null,i.a.createElement("a",{href:"#",onClick:function(t){e.onOrderItemDelete(Object(s.a)({},e))}},"\u5220\u9664"))))}));var ge=i.a.memo(function(e){console.log("Order",e);var t,n=Object(u.useContext)($),a=Object(u.useCallback)(I.a.throttle(function(t){console.log("onOrderItemChange"),n({type:me,payload:Object(s.a)({},t,{orderId:e.id})})},0),[]),r=Object(u.useCallback)(function(t){console.log("onOrderItemDelete"),n({type:de,payload:Object(s.a)({},t,{orderId:e.id})})},[]);return i.a.createElement(M,null,i.a.createElement(B,null,i.a.createElement("span",null,e.title)),i.a.createElement(G,null,i.a.createElement("table",null,i.a.createElement("colgroup",null,i.a.createElement("col",{style:{width:"50px"}}),i.a.createElement("col",{style:{width:"50px"}}),i.a.createElement("col",{style:{width:"100px"}}),i.a.createElement("col",{style:{width:"100px"}}),i.a.createElement("col",{style:{width:"100px"}}),i.a.createElement("col",{style:{width:"70px"}}),i.a.createElement("col",{style:{width:"80px"}}),i.a.createElement("col",{style:{width:"80px"}}),i.a.createElement("col",{style:{width:"80px"}}),i.a.createElement("col",{style:{width:"80px"},align:"center"})),i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\u9009\u4e2d"),i.a.createElement("th",null,"\u5e8f\u53f7"),i.a.createElement("th",null,"\u5206\u7c7b"),i.a.createElement("th",null,"\u540d\u79f0"),i.a.createElement("th",null,"\u89c4\u683c"),i.a.createElement("th",null,"\u5355\u4f4d"),i.a.createElement("th",null,"\u5355\u4ef7"),i.a.createElement("th",null,"\u6570\u91cf"),i.a.createElement("th",null,"\u603b\u4ef7"),i.a.createElement("th",null,"\u64cd\u4f5c"))),i.a.createElement("tbody",null,e.items?e.items.map(function(e,t){return i.a.createElement(he,Object.assign({index:t,key:e.id},e,{onOrderItemChange:a,onOrderItemDelete:r}))}):null)),i.a.createElement("span",null,"\u603b\u91d1\u989d:",e.items?(t=e)&&t.items?t.items.filter(function(e){return e.checked}).map(function(e){return e.count*e.price}).reduce(function(e,t){return e+t},0).toFixed(2):0:null),i.a.createElement("div",null,i.a.createElement("button",{onClick:function(t){return n({type:ie,payload:{orderId:e.id}})}},"\u6dfb\u52a0\u9879\u76ee"),i.a.createElement("button",{style:{marginLeft:"8px"},onClick:function(t){ce(e.id)}},"\u5bfc\u51fa"),i.a.createElement("button",{style:{marginLeft:"8px"},onClick:function(e){var t;t=JSON.parse(localStorage.getItem("contractor")),console.log("saveContractor",t),re(ae,{method:"PUT",headers:{"Content-Type":"application/json"},body:t?JSON.stringify(t):""}).then(function(e){e.ok?alert("\u5bfc\u5165\u6210\u529f\uff01"):alert("\u5bfc\u5165\u5931\u8d25\uff01"+e.status)})}},"\u4fdd\u5b58"))))}),be=i.a.memo(function(e){var t=e.orders,n=Object(u.useContext)($);return i.a.createElement("div",{className:"App"},i.a.createElement("div",null,i.a.createElement("div",null,t.map(function(t,n){return i.a.createElement(ge,Object.assign({key:n},t,{person:e.person}))})),i.a.createElement("div",{style:{margin:"32px"}},i.a.createElement("button",{onClick:function(e){return n({type:oe})}},"ADD ORDER"))))}),ve=n(23);function Oe(e,t){switch(t.type){case ie:if(e.items){var n={id:x.a.generate(),count:0,price:0};return Object(s.a)({},e,{items:Object(ve.a)(e.items).concat([n])})}var a=[{id:x.a.generate(),count:0,price:0}];return Object(s.a)({},e,{items:a});case de:if(console.log("DELETE_ORDER_ITEM"+t.payload.id),t.payload.id){var r=e.items.filter(function(e){return e.id!==t.payload.id});return Object(s.a)({},e,{items:r})}return e;case me:if(t.payload.id){r=e.items.map(function(e){return e.id===t.payload.id?t.payload:e});return e.items=r,e}return e;default:return e}}function ye(e,t){switch(console.log(t),t.type){case pe:return Object(ve.a)(t.payload);case ie:case de:case me:return t.payload.orderId?e.map(function(e){return e.id===t.payload.orderId?Oe(e,t):e}):e;case oe:return Object(ve.a)(e).concat([{id:x.a.generate()}]);case ue:return e.map(function(e){return Oe(e,t)});default:return e}}function je(e,t){switch(t.type){case se:return Object(s.a)({},t.payload);default:return e}}function xe(e,t){switch(t.type){case se:return Object(s.a)({},e,{person:je(e.person,t)});case fe:return Object(s.a)({},e,t.payload);case Ee:return t.payload;default:return Object(s.a)({},e,{orders:ye(e.orders,t)})}}var Ce=i.a.memo(function(e){return console.log("person-------222",e),i.a.createElement("div",null,i.a.createElement(K,null,i.a.createElement(V,null,"\u59d3\u540d:"),i.a.createElement("input",{style:{width:"300px"},value:e.name,onChange:function(t){e.onPersonChange(Object(s.a)({},e,{name:t.target.value}))}})),i.a.createElement(K,null,i.a.createElement(V,null,"\u8eab\u4efd\u8bc1:"),i.a.createElement("input",{style:{width:"300px"},value:e.idno,onChange:function(t){e.onPersonChange(Object(s.a)({},e,{idno:t.target.value}))}})),i.a.createElement(K,null,i.a.createElement(V,null,"\u4f4f\u5740:"),i.a.createElement("input",{style:{width:"300px"},value:e.address,onChange:function(t){e.onPersonChange(Object(s.a)({},e,{address:t.target.value}))}})))}),we=Z.baseUrl+"/contractor/commoditys",ke=y.a(function(e){return e.category});function Ie(){console.log("Contractor");var e=Object(u.useReducer)(xe,function(){console.log("getValue.................");var e=window.localStorage.getItem("contractor");try{return e?JSON.parse(e):null}catch(t){window.localStorage.removeItem("contractor")}}()),t=Object(O.a)(e,2),n=t[0],a=t[1];Object(u.useEffect)(function(e){console.log("fetch...............",n),n||fetch(we).then(function(e){console.log("fetch...............",e),e.ok&&e.json().then(function(e){var t,n,r,l;a({type:Ee,payload:{person:{name:"",idno:"",address:"\u56de\u98ce\u8857\u9053\u529e\u4e8b\u5904\u5927\u6eaa\u53e3\u6751   \u7ec4"},orders:(t=e,n=t.map(function(e){return Object(s.a)({},e,{name:e.name||"",price:te(e.price)?new w.a(e.price).toFixed(2):0,count:0,checked:!1})}),r=ke(n),l=Object.keys(r).map(function(e){return{id:x.a.generate(),title:e,items:r[e]}}),console.log(l),l)}})})})},[]),Object(u.useEffect)(function(e){var t=JSON.stringify(n);window.localStorage.setItem("contractor",t)},[n]);var r=Object(u.useCallback)(I.a.throttle(function(e){console.log("memoizedPersonCallback"),a({type:se,payload:e})},0),[]);return i.a.createElement("div",null,i.a.createElement($.Provider,{value:a},i.a.createElement(M,null,i.a.createElement(z,{primary:!0,onClick:function(){window.localStorage.removeItem("contractor"),alert("\u6e05\u7406\u6210\u529f"),window.history.pushState("/contractor/add",null,"/contractor/add")}},"\u6e05\u9664")),n?i.a.createElement("div",null,i.a.createElement(M,null,i.a.createElement(B,null,"\u5408\u540c\u57fa\u672c\u4fe1\u606f"),i.a.createElement(G,null,i.a.createElement(K,null,i.a.createElement(V,null,"\u5408\u540c\u540d\u79f0:"),i.a.createElement("input",{value:n.name,onChange:function(e){a({type:fe,payload:{name:e.target.value}})}})),i.a.createElement(K,null,i.a.createElement(V,null,"\u534f\u8bae\u7f16\u53f7:"),i.a.createElement("input",{value:n.agreementId,onChange:function(e){a({type:fe,payload:{agreementId:e.target.value}})}})))),i.a.createElement(M,null,i.a.createElement(B,null,"\u4f4f\u6237\u4fe1\u606f"),i.a.createElement(G,null,i.a.createElement(Ce,Object.assign({},n.person,{onPersonChange:r})))),i.a.createElement("div",null,n.orders?i.a.createElement(be,{orders:n.orders}):null)):null))}var Re=Z.baseUrl+"/contractor";function Ne(){var e,t,n,a,r,l=Y(Re+"/_search",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({})}),c=(e=null,t=Object(u.useState)(e),n=Object(O.a)(t,2),a=n[0],r=n[1],{value:a,onChange:function(e){r(e.target.value)}});return console.log("ContractorList"),i.a.createElement("div",null,i.a.createElement(M,null,i.a.createElement(K,null,i.a.createElement(V,null,"\u5173\u952e\u8bcd:"),i.a.createElement("input",Object.assign({},c,{style:{width:"300px"}})))),i.a.createElement(M,null,i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\u59d3\u540d"),i.a.createElement("th",null,"\u8eab\u4efd\u8bc1"),i.a.createElement("th",null,"\u534f\u8bae\u53f7"),i.a.createElement("th",null,"\u521b\u5efa\u65f6\u95f4"),i.a.createElement("th",null,"\u64cd\u4f5c"))),i.a.createElement("tbody",null,l?l.filter(function(e){return!!Object(k.isEmpty)(c.value)||(t=(e.personName||"")+(e.personIdno||""),n=c.value,null!=t&&null!=n&&-1!=t.indexOf(n));var t,n}).map(function(e,t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,e.personName),i.a.createElement("td",null,e.personIdno),i.a.createElement("td",null,e.agreementId),i.a.createElement("td",null,e.createDate),i.a.createElement("td",null,i.a.createElement(v,{style:{width:"200px;"},to:"/contractor/edit/"+e.id,key:e.id},"\u4fee\u6539")))}):null))))}n(171);var De=n(30),Se=n(32),Te={person:{name:"",idno:"",address:"\u56de\u98ce\u8857\u9053\u529e\u4e8b\u5904\u5927\u6eaa\u53e3\u6751   \u7ec4"},orders:[]};function Pe(e){console.log("ContractorEdit",e.history.params.id);var t=e.history.params.id;window.localStorage.removeItem("contractor");var n=Object(u.useReducer)(xe,Te),a=Object(O.a)(n,2),r=a[0],l=a[1],c=Y(Z.baseUrl+"/contractor/"+t,{method:"GET",headers:{Accept:"application/json"}});Object(u.useEffect)(function(e){c&&(console.log("initContractor",c),l({type:Ee,payload:c}))},[c]),Object(u.useEffect)(function(e){console.log("useEffect.contractor",r);var t=JSON.stringify(r);window.localStorage.setItem("contractor",t)},[r]);var o=Object(u.useCallback)(I.a.throttle(function(e){console.log("memoizedPersonCallback"),l({type:se,payload:e})},0),[]);return i.a.createElement("div",null,i.a.createElement($.Provider,{value:l},i.a.createElement(M,null,i.a.createElement(B,null,"\u5408\u540c\u57fa\u672c\u4fe1\u606f"),i.a.createElement(G,null,i.a.createElement(K,null,i.a.createElement(V,null,"\u5408\u540c\u540d\u79f0:"),i.a.createElement("input",{value:r.name,onChange:function(e){l({type:fe,payload:{name:e.target.value}})}})),i.a.createElement(K,null,i.a.createElement(V,null,"\u534f\u8bae\u7f16\u53f7:"),i.a.createElement("input",{value:r.agreementId,onChange:function(e){l({type:fe,payload:{agreementId:e.target.value}})}})))),i.a.createElement(M,null,i.a.createElement(B,null,"\u4f4f\u6237\u4fe1\u606f"),i.a.createElement(G,null,i.a.createElement(Ce,Object.assign({},r.person,{onPersonChange:o})))),i.a.createElement("div",null,r.orders?i.a.createElement(be,{orders:r.orders}):null)))}function Ue(){var e=Object(R.a)(["\n    margin-left:130px;\n    display:block;\n    flex:1;\n"]);return Ue=function(){return e},e}function _e(){var e=Object(R.a)(["\n    display:block;\n    position:fixed;\n    width:130px;\n"]);return _e=function(){return e},e}function Ae(){var e=Object(R.a)(["\n    display:flex;\n"]);return Ae=function(){return e},e}var Je=N.default.div(Ae()),Le=N.default.div(_e()),Fe=N.default.div(Ue());function Me(){return i.a.createElement(Je,null,i.a.createElement(Le,null,i.a.createElement(q,null,i.a.createElement(H,null,i.a.createElement(De.a,{icon:Se.a}),i.a.createElement(v,{to:"/contractor"},"\u4f4f\u6237\u5217\u8868")),i.a.createElement(H,null,i.a.createElement(De.a,{icon:Se.b}),i.a.createElement(v,{to:"/contractor/add"},"\u6dfb\u52a0\u4f4f\u6237")))),i.a.createElement(Fe,null,i.a.createElement(g,{exact:!0,path:"/contractor",component:Ne}),i.a.createElement(g,{exact:!0,path:"/contractor/add",component:Ie}),i.a.createElement(g,{exact:!0,path:"/contractor/edit/:id",component:Pe})))}var ze=function(e){function t(){return Object(a.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return i.a.createElement(b,null,i.a.createElement(g,{path:"/",component:Me}))}}]),t}(i.a.Component),Be=document.getElementById("root");m.a.render(i.a.createElement(ze,null),Be)},68:function(e,t,n){e.exports=n(172)},73:function(e,t,n){}},[[68,2,1]]]);
//# sourceMappingURL=main.40fb8039.chunk.js.map